@model IEnumerable<BugTracker.Models.Tickets>
@using Microsoft.AspNet.Identity
@{
    ViewBag.Title = "Index";
}

<h2>All Tickets</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table id="ticketIndex">
    <thead>
    <tr>
        <th>Assigned To</th>
        <th>Owned By</th>
        <th>Project Name</th>
        <th>Status</th>
        @*<th>Ticket Type</th>*@
        <th>@Html.DisplayNameFor(model => model.Title)</th>
        <th>@Html.DisplayNameFor(model => model.Created)</th>
        @*<th>@Html.DisplayNameFor(model => model.Updated)</th>*@
        <th>Priority</th>
        @*@if(User.IsInRole("ProjectManager") || User.IsInRole("Developer"))
        {*@   <th> </th>  
        @*}*@
    </tr>
   </thead>

    <tbody>
@foreach (var item in Model)
{
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.AssignedToUser.FirstName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.OwnerUser.FirstName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Project.ProjectName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.TicketStatus.StatusName)
        </td>
        @*<td>
                @Html.DisplayFor(modelItem => item.TicketType.TicketName)
            </td>*@
        <td>
            @Html.DisplayFor(modelItem => item.Title)
        </td>
        <td>
            @*@Html.DisplayFor(modelItem => item.Created)*@
            @item.Created.ToString("MM/dd/yy")
        </td>
        @*<td>
                @Html.DisplayFor(modelItem => item.Updated)
            </td>*@
        <td>
            @Html.DisplayFor(modelItem => item.TicketPriority.PriorityName)
        </td>
        @if (@item.AssignedToUserId == User.Identity.GetUserId() || User.IsInRole("ProjectManager"))
        {
            <td>
                @Html.ActionLink("Details", "Details", new { id = item.Id })|
                @Html.ActionLink("Edit", "Edit", new { id = item.Id })
            </td>
        }
        else
        {
            <td>@Html.ActionLink("Details", "Details", new { id = item.Id })</td>
        }
        
    </tr>
}
        </tbody>

</table>

@section scripts
{
    <script type="text/javascript">
        $(document).ready(function () {
            $('#ticketIndex').DataTable();
        });
    
    </script>
}